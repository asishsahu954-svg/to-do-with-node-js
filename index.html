<!DOCTYPE html>
<html>
<head>
<title>To-Do App</title>

<style>
body {
  font-family: Arial;
  background: #f4f4f4;
}
.container {
  width: 400px;
  margin: 40px auto;
  background: rgb(223, 98, 223);
  padding: 20px;
  border-radius: 20px;
}
input, button {
  width: 100%;
  padding: 5px;
  margin: 5px 0;
}
li {
  list-style: none;
  background: #79b5f0;
  padding: 8px;
  margin: 5px 0;
  border-radius: 12px;
}
.done {
  text-decoration: line-through;
  color: green;
}
.actions button {
  width: auto;
  margin-right: 5px;
}
.btn {
  background-color: rgb(0, 0, 0);
  color: rgb(235, 235, 235);
}
.btn:hover {
  background-color: rgb(231, 243, 18);
}
.mark {
  background-color: rgb(51, 215, 22);
}
.del {
  background-color: rgb(234, 61, 61);
  border-radius: 30px;
  color: white;
}
</style>

</head>

<body>
<div class="container">
  <h2>To-Do App</h2>

  <input type="text" id="taskInput" placeholder="Enter task">
  <button class="btn" onclick="addTask()">Add Task</button>

  <ul id="taskList"></ul>
</div>

<script>
function loadTasks() {
  fetch("/tasks")
    .then(res => res.json())
    .then(data => {
      taskList.innerHTML = "";
      data.forEach(t => {
        taskList.innerHTML += `
          <li class="${t.status === 'Done' ? 'done' : ''}">
            ${t.task} (${t.status})
            <div class="actions">
              <button class="mark" onclick="markDone(${t.id})">Done</button>
              <button class="del" onclick="deleteTask(${t.id})">Delete</button>
            </div>
          </li>
        `;
      });
    });
}

function addTask() {
  const task = taskInput.value.trim();
  if (task === "") {
    alert("Please enter a task.");
    return;
  }

  fetch("/add", {  /* Updated to match your backend route */
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ task })
  })
  .then(response => response.text())
  .then(msg => {
    alert(msg);      // alert success message
    taskInput.value = "";
    loadTasks();
  });
}

function markDone(id) {
  fetch("/update/" + id, { method: "PUT" })
    .then(response => response.text())
    .then(msg => {
      alert(msg);
      loadTasks();
    });
}

function deleteTask(id) {
  fetch("/delete/" + id, { method: "DELETE" })
    .then(response => response.text())
    .then(msg => {
      alert(msg);
      loadTasks();
    });
}

loadTasks();
</script>

</body>
</html>
